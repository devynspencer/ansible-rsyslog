{{ ansible_managed | comment }}

ruleset(name="local") {

	if $inputname != "imfile" then {

		module(load="imklog")

		module(load="builtin:omfile"
			{% if rsyslog_default_omfile_template is defined %}
			template="{{ rsyslog_default_omfile_template }}"
			{% endif %}
			dirCreateMode="{{ rsyslog_directory_mode }}"
			fileCreateMode="{{ rsyslog_file_mode }}"
			fileOwner="{{ rsyslog_file_owner }}"
			fileGroup="{{ rsyslog_file_group }}"
			dirOwner="{{ rsyslog_directory_owner }}"
			dirGroup="{{ rsyslog_directory_group }}"
		)

		{% for log in rsyslog_local_output %}
		{{ log.facility | default("*") }}.{{ log.severity | default("*") }} action(
			name="local_{{ log.facility | default("*") }}"
			type="omfile"
			file="{{ log.file }}"
		)
		{% endfor %}

	}

}

$DefaultRuleset local
